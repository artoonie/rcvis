{% load static %}
{% load compress %}

{% compress js file %}
<script type="module" src="{% static 'pie/pie-chart.es.js' %}"></script>
{% endcompress %}

<script>

    const electionSummary = JSON.parse(document.getElementById("rawDataId").textContent);

    // Create the pie-chart element
    const pieChart = document.createElement("pie-chart");
    pieChart.setAttribute("electionSummary", JSON.stringify(electionSummary));
    pieChart.setAttribute('onRoundChanged', updateSliderRound);

    // Append it to the div
    document.getElementById("pie-body").appendChild(pieChart);

    trs_createSliderAndTimeline({
      wrapperDivId: 'pie-slider-container',
      numTicks: numRounds,
      tickText: generateTickTexts(numRounds),
      hideActiveTickText: doHideActiveTickText(numRounds),
      sliderValueChanged: updatePieChartRound,
      timelineData: generateTimelineData(humanFriendlyEventsPerRound),
      timelinePeeking: !config.doUseDescriptionInsteadOfTimeline,
      timeBetweenStepsMs: 3000
    });

 

    // Create a callback which simulates a click on the hidden slider
    function updatePieChartRound(roundNum) {
        pieChart.setAttribute("currentRound", roundNum+1);
    }

    function updateSliderRound(roundNum) {
        document.getElementById('pie-slider-container').setAttribute('value', roundNum-1);
    }

</script>
