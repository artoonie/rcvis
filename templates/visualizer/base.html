{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
<!-- This needs to be the first bit of js loaded to get the correct configs throughout -->
<script>
  var getUrlParameter = function getUrlParameter(sParam)
  {
      // Courtesy of https://stackoverflow.com/a/21903119/1057105
      var sPageURL = window.location.search.substring(1),
          sURLVariables = sPageURL.split('&'),
          sParameterName,
          i;
  
      for (i = 0; i < sURLVariables.length; i++) {
          sParameterName = sURLVariables[i].split('=');
  
          if (sParameterName[0] === sParam) {
              return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
          }
      }
  };

  var config = {};

  // 1. Load from django (happens once on baking)
  config.rotateNames = {% if config.rotateNames %} true {% else %} false {% endif %};
  config.horizontalSankey = {% if config.horizontalSankey %} true {% else %} false {% endif %};
  config.onlyShowWinnersTabular = {% if config.onlyShowWinnersTabular %} true {% else %} false {% endif %};
  config.doHideOverflowAndEliminated = {% if config.doHideOverflowAndEliminated %} true {% else %} false {% endif %};
  config.doUseHorizontalBarGraph = {% if config.doUseHorizontalBarGraph %} true {% else %} false {% endif %};
  config.hideSankey = {% if config.hideSankey %} true {% else %} false {% endif %};
  config.hideTabular = {% if config.hideTabular %} true {% else %} false {% endif %};

  // 2. Load any overrides (not supported in Internet Explorer)
  let searchParams = new URLSearchParams(window.location.search);
  for (var key in config) {
    if (searchParams.has(key))
    {
      // We use hidden fields to make sure all checkboxes get sent over GET when updating settings.
      // There seems to be some protocol that claims the last one is the valid one...so grab the last.
      allValues = searchParams.getAll(key)
      lastValue = allValues[allValues.length - 1]
      console.log("Key: " + key + "    =   " + lastValue)
      config[key] = lastValue == "on";
    }
  }
</script>

{% include "visualizer/common-header.html" %}

{% block header %}
{% endblock %}

</head>

<body id="page-top">
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand js-scroll-trigger" href="/index.html">RCVIS</a>
      <button class="navbar-toggler navbar-toggler-right text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
{% block navlinks %}
{% endblock %}
        </ul>
      </div>
    </div>
  </nav>

{% block maincontent %}
{% endblock %}

  <!-- Footer -->
  <footer class="footer text-center">
    <div class="container">
      <div class="row">

        <!-- Footer Location -->
        <div class="col-lg-4 mb-5 mb-lg-0">
          <h4 class="text-uppercase mb-4">Supported File Formats</h4>
          <a href="https://www.rankedchoicevoting.org/universal_rcv_tabulator">Universal RCV Tabulator</a>
          <br/><a href="https://www.opavote.com/methods/ranked-choice-voting">Opavote's Online Elections</a>
        </div>

        <!-- Footer Social Icons -->
        <div class="col-lg-4 mb-5 mb-lg-0">
          <h4 class="text-uppercase mb-4">Online</h4>
          <a class="btn btn-outline-light btn-social mx-1" href="https://github.com/artoonie/rcvis">
            <i class="fab fa-fw fa-github"></i>
          </a>
          <a class="btn btn-outline-light btn-social mx-1" href="https://github.com/artoonie/rcvis/projects/1">
            <i class="fas fa-bug"></i>
          </a>
          <a class="btn btn-outline-light btn-social mx-1" href="https://medium.com/@armin.samii/an-illustrated-guide-to-ranked-choice-voting-4ce3c5fe73f9">
            <i class="fab fa-fw fa-medium"></i>
          </a>
          <a class="btn btn-outline-light btn-social mx-1" href="mailto:team@rcvis.com">
            <i class="fas fa-at"></i>
          </a>
        </div>

        <!-- Footer About Text -->
        <div class="col-lg-4">
          <h4 class="text-uppercase mb-4">About</h4>
          <p class="lead mb-0">RCVIS is open-source Ranked-Choice Voting Visualization software. Get in touch if you'd like help visualize an upcoming election with our software: <a href="mailto:team@rcvis.com">team@rcvis.com</a>.</p>
        </div>

      </div>
    </div>
  </footer>

  <!-- Copyright Section -->
  <section class="copyright py-4 text-center text-white">
    <div class="container">
      <small>Copyright &copy; Armin Samii 2019</small>
    </div>
  </section>

  <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
  <div class="scroll-to-top d-lg-none position-fixed ">
    <a class="js-scroll-trigger d-block text-center text-white rounded" href="#page-top">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>

{% block etc %}
{% endblock %}
</body>

</html>

